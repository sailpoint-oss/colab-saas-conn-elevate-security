{
	"name": "Elevate Security Disable Account",
	"description": "",
	"modified": "2023-02-07T22:14:24.521819935Z",
	"modifiedBy": {
		"type": "IDENTITY",
		"id": "2c9180846c637834016c913bf9da0667",
		"name": "dhara.shah"
	},
	"definition": {
		"start": "Loop",
		"steps": {
			"Loop": {
				"actionId": "sp:loop:iterator",
				"attributes": {
					"input.$": "$.trigger.persons[*]",
					"start": "Get Identity",
					"steps": {
						"Compare Numbers": {
							"choiceList": [
								{
									"comparator": "NumericLessThan",
									"nextStep": "Send Email 1",
									"variableA.$": "$.getAccounts.accounts.length",
									"variableB": 1
								}
							],
							"defaultStep": "Manage Accounts",
							"description": "Check if the identity contains accounts, if true it will continue to disable the account and create certification campaign otherwise just send an email for notification.",
							"type": "choice"
						},
						"Create Certification Campaign": {
							"actionId": "sp:create-campaign",
							"attributes": {
								"activateUponCreation": true,
								"description": "Disable the accounts for the Identity.",
								"duration": "1d",
								"emailNotificationEnabled": true,
								"name": "Elevate Security- Disable Account",
								"reviewerCertificationType": "IDENTITY",
								"reviewerId": "2c9180846c637834016c913bf9da0667",
								"reviewerIdentitiesToCertify.$": "$.getIdentity.id",
								"sourceIds.$": "$.getAccounts.accounts[*].sourceId",
								"type": "REVIEWER_IDENTITY"
							},
							"nextStep": "Send Email",
							"type": "action",
							"versionNumber": 2
						},
						"Get Accounts": {
							"actionId": "sp:get-accounts",
							"attributes": {
								"getAccountsBy": "specificIdentity",
								"identity.$": "$.getIdentity.id"
							},
							"description": "Get the accounts for the Identity based on the ID.",
							"nextStep": "Compare Numbers",
							"type": "action",
							"versionNumber": 1
						},
						"Get Identity": {
							"actionId": "sp:get-identity",
							"attributes": {
								"id.$": "$.loop.loopInput.nid"
							},
							"description": "Get the identity from the incoming payload.",
							"nextStep": "Get Accounts",
							"type": "action",
							"versionNumber": 2
						},
						"Manage Accounts": {
							"actionId": "sp:manage-account",
							"attributes": {
								"accountIds.$": "$.getAccounts.accounts[*].id",
								"operation": "disable"
							},
							"nextStep": "Create Certification Campaign",
							"type": "action",
							"versionNumber": 1
						},
						"Send Email": {
							"actionId": "sp:send-email",
							"attributes": {
								"body": "Dear User,\n\nA certification campaign is created and activated. Here are the details of the request:\n\nCertification Id: ${certificationID}\nIdentity Name: ${name}\nIdentity ID: ${identityID}",
								"context": {
									"certificationID.$": "$.createCertificationCampaign.id",
									"identityID.$": "$.getIdentity.id",
									"name.$": "$.getIdentity.name"
								},
								"from": null,
								"recipientEmailList": [
									"dhara.shah@sailpoint.com"
								],
								"replyTo": null,
								"subject.$": "$.getIdentity.displayName"
							},
							"description": null,
							"nextStep": "success",
							"type": "action",
							"versionNumber": 2
						},
						"Send Email 1": {
							"actionId": "sp:send-email",
							"attributes": {
								"body": "",
								"context": {},
								"from": null,
								"recipientEmailList": [
									"dhara.shah@sailpoint.com"
								],
								"replyTo": null,
								"subject.$": "$.getIdentity.displayName"
							},
							"description": "",
							"nextStep": "failure",
							"type": "action",
							"versionNumber": 2
						},
						"failure": {
							"description": "There are no accounts associated with the identity.",
							"failureDetails": "There are no accounts associated with the identity.",
							"failureName": "No Accounts to disabled",
							"type": "failure"
						},
						"success": {
							"description": "Workflow completed successfully,",
							"type": "success"
						}
					}
				},
				"description": "This steps loops through the incoming person's array and launch a series of steps for each identity in it.",
				"nextStep": "success 1",
				"type": "action",
				"versionNumber": 1
			},
			"success 1": {
				"type": "success"
			}
		}
	},
	"creator": {
		"type": "IDENTITY",
		"id": "2c9180846c637834016c913bf9da0667",
		"name": "dhara.shah"
	},
	"trigger": {
		"type": "EXTERNAL",
		"attributes": {
			"clientId": "607b8e7c-4966-420f-81b3-e680b384d29d",
			"description": "Elevate Security- Launch the workflow based on Risk Detection Rule.",
			"url": "https://identity-plus-1.api.identitynow.comhttps://identity-plus-1.api.identitynow.comhttps://identity-plus-1.api.identitynow.com/beta/workflows/execute/external/340fdadb-2416-4280-9ff7-5a6cb1dc1955"
		}
	}
}